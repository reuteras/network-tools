# Network tools 

Scripts and configuration to use zeek with [Rita](https://github.com/activecm/rita) and [zeek2es](https://github.com/corelight/zeek2es). 

## Usage - Zeek

Generate [Zeek](https://zeek.org/) logs in one of two ways. Either copy pcap to the *pcap* subdirectory. Then run 

    make zeek-output

If you have pcaps in other places and don't want to copy them you can run:

    ./bin/process-pcaps.sh <path to pcaps>

If you already have Zeek logs just copy them to a directory named *output* in this directory.

## Usage - rita

After you have created Zeek logs generate the [rita](https://github.com/activecm/rita) report by running:

    make rita-generate-report

View the report generated by rita by running:

    make rita-open-report

## Usage - Elastic

Import to Elastic with (view http://127.0.0.1:5601) with zeek2es:

    make zeek-zeek2es-import

or via Elastic Filebeat:

    make zeek-json-import

## Links

More information about tools used in this project.

- [zeek](https://zeek.org/)
- [rita](https://github.com/activecm/rita) - Check for updates in [docker-compose.yml](https://github.com/activecm/rita/blob/master/docker-compose.yml)
- [zeek2es](https://github.com/corelight/zeek2es) under this [License](https://github.com/corelight/zeek2es/blob/master/LICENSE). Introduction video on [Youtube](https://www.youtube.com/watch?v=Ahe4jmdB2uQ)

## TODO

- How should [Sigma](https://github.com/SigmaHQ/sigma) rules be included?
- Look at [How to hunt with Zeek using Sigma rules for your SIEM](https://www.youtube.com/watch?v=B20u53S72zA)
- Sigma rules for Cobalt strike (but no pcap) can be found in [Cobalt Strike, a Defender’s Guide](https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/) and in [Cobalt Strike, a Defender’s Guide – Part 2](https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/) by The DFIR Report.
- Configure local networks for Zeek and other configuration changes
- Look at [docker-zeek](https://github.com/blacktop/docker-zeek)

